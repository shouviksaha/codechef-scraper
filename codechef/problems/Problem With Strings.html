<div style='width:800px;margin:50px'><div class="content">
<h3>All submissions for this problem are available.</h3>
<div id="kanpur">
<div class="tabular">
<table id="TBL-1" class="tabular" cellspacing="0" cellpadding="0"><colgroup id="TBL-1-1g"><col id="TBL-1-1"><br><col id="TBL-1-2"><br></colgroup><tr style="vertical-align:baseline;" id="TBL-1-1-"><td style="white-space:nowrap; text-align:center;" id="TBL-1-1-1" class="td11">
          <a id="x1-2r1" name="x1-2r1"></a><span class="cmssbx-10x-x-600">A</span></td>
<td style="white-space:nowrap; text-align:center;" id="TBL-1-1-2" class="td11">
<!--tex4ht:inline--><!--tex4ht:inline--><div class="tabular">
<table id="TBL-2" class="tabular" cellspacing="0" cellpadding="0"><colgroup id="TBL-2-1g"><col id="TBL-2-1"><br></colgroup><tr style="vertical-align:baseline;" id="TBL-2-1-"><td style="white-space:nowrap; text-align:left;" id="TBL-2-1-1" class="&lt;br"></td>
                  "td11"&gt;<span class="cmssbx-10x-x-172">Problem with Strings</span>
</tr><tr style="vertical-align:baseline;" id="TBL-2-2-"><td style="white-space:nowrap; text-align:left;" id="TBL-2-2-1" class="&lt;br"></td>
                  "td11"&gt;<br><!--tex4ht:inline--><!--tex4ht:inline--><div class="tabular">
<table id="TBL-3" class="tabular" cellspacing="0" cellpadding="0"><colgroup id="TBL-3-1g"><col id="TBL-3-1"><br><col id="TBL-3-2"><br></colgroup><tr style="vertical-align:baseline;" id="TBL-3-1-"><td style="white-space:nowrap; text-align:left;" id="TBL-3-1-1"></td>
                          class="td10"&gt;Input file:
<td style="white-space:nowrap; text-align:left;" id="TBL-3-1-2"></td>
                          class="td01"&gt;<span class="cmtt-10x-x-109">stdin</span>
</tr><tr style="vertical-align:baseline;" id="TBL-3-2-"><td style="white-space:nowrap; text-align:left;" id="TBL-3-2-1"></td>
                          class="td10"&gt;Output file:
<td style="white-space:nowrap; text-align:left;" id="TBL-3-2-2"></td>
                          class="td01"&gt;<span class="cmtt-10x-x-109">stdout</span>
</tr><tr style="vertical-align:baseline;" id="TBL-3-3-"><td style="white-space:nowrap; text-align:left;" id="TBL-3-3-1"></td>
                          class="td10"&gt;
</tr></table></div>

</tr></table></div>
</td>
</tr><tr style="vertical-align:baseline;" id="TBL-1-2-"><td style="white-space:nowrap; text-align:center;" id="TBL-1-2-1" class="td11">
          </td>
</tr></table></div>
<!--l. 4--><!--l. 4--><p class="noindent">Today, we will be unraveling the mysteries of one of the most<br>
    twisted and curly beasts in all existence knots! The problem here is simple: given<br>
    the picture of a string laid out curled on a table, you are to determine if it will<br>
    curl up into a knot when the ends are pulled out.</p>
<div class="center">
<!--l. 5--><!--l. 5--><p class="noindent"></p>
<div class="verbatim" id="verbatim-1">
        ...............  <br>
        ...+------+....  <br>
        ...|......|....  <br>
        ...|...+--H----  <br>
        ...|...|..|....  <br>
        ---I---H--+....  <br>
        ...|...|.......  <br>
        ...+---+.......  <br>
        ...............
      </div>
<!--l. 16--><!--l. 16--><p class="nopar"></p>
</div>
<!--l. 18--><!--l. 18--><p class="noindent">The input will consist of a diagram of one single continuous<br>
    string described in a two-dimensional grid of characters such as shown above. The<br>
    ‘<span class="cmsy-10x-x-109">−</span>’ and ‘<span class="&lt;br"></span>
    "cmsy-10x-x-109"&gt;|’ characters represent a horizontal and vertical<br>
    segment of the string, respectively. ‘+’ characters represent corners<br>
    where the string turns at right angles on the table. ‘I’ or<br>
    ‘H’ characters represent locations where parts of the strings cross:</p>
<ul class="itemize1"><li class="itemize">‘H’ represents locations where the horizontal<br>
      string passes over the vertical string</li>
<li class="itemize">‘I’ represents locations where the horizontal<br>
      string passes under the vertical string</li>
</ul><!--l. 23--><!--l. 23--><p class="noindent">The dot character, ‘<span class="obeylines-h"><span class="&lt;br"></span>
    "verb"&gt;<span class="cmtt-10x-x-109">.</span></span>’, obviously,<br>
    represents empty spaces of the table unoccupied by the string. Two horizontally<br>
    adjacent non-empty spaces of the table are connected by the string iff neither of<br>
    them are ‘<span class="obeylines-h"><span class="verb"><span class="&lt;br"></span>
    "cmtt-10x-x-109"&gt;|</span></span>’ characters. Similarly, vertically<br>
    adjacent non-empty spaces are connected by the string iff neither of them are<br>
    ‘<span class="obeylines-h"><span class="verb"><span class="&lt;br"></span>
    "cmtt-10x-x-109"&gt;-</span></span>’ characters. Inputs will be such that<br>
    every ‘<span class="obeylines-h"><span class="verb"><span class="&lt;br"></span>
    "cmtt-10x-x-109"&gt;+</span></span>’ character will represent a proper<br>
    corner where the string turns at a unambiguously at a right angle: formally, every<br>
    ‘<span class="obeylines-h"><span class="verb"><span class="&lt;br"></span>
    "cmtt-10x-x-109"&gt;+</span></span>’ character will be connected to exactly<br>
    one vertically adjacent and exactly one horizontally adjacent space. Moreover, to<br>
    further simplify matters, you can assume that the only characters along the border of<br>
    the given diagram, other than dots, will represent endpoints of the string. In short,<br>
    the input will unambiguously specify a valid piece of string starting and ending at<br>
    the border of the input diagram. Finally, assume that the string has negligible width<br>
    and is made of a very smooth material, so that parts of the string can easily slide<br>
    over each other with negligible friction. </p>
<!--l. 27--><!--l. 27-->
<p class="noindent"><span class="cmssbx-10x-x-144">Input</span> </p>
<!--l. 29--><!--l. 29-->
<p class="noindent">The input will consist of at most 80 test cases. Each test case<br>
    will start with a single line containing two integers, <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;r and <span class="cmmi-10x-x-109">c</span>, indicating that<br>
    the size of the diagram for that case is of <span class="cmmi-10x-x-109">r</span><br>
    rows and <span class="cmmi-10x-x-109">c</span> columns. This line will be followed by<br><span class="cmmi-10x-x-109">r</span> more lines, each with exactly <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;c characters, with characters in each line representing a row<br>
    of the diagram. You may assume that 2 <span class="cmsy-10x-x-109">≤</span><br><span class="cmmi-10x-x-109">r,c</span> <span class="cmsy-10x-x-109">≤</span> 120.</p>
<!--l. 31--><!--l. 31-->
<p class="noindent"><span class="cmssbx-10x-x-144">Output</span> </p>
<!--l. 33--><!--l. 33-->
<p class="noindent">The output should consist of exactly one line for each test case<br>
    in the format Case c: Response, where c is the test case serial number, starting from<br>
    1, and Response is either the string straightened or knotted (without the quotes)<br>
    depending on whether the string will straighten out or coil up into a knot,<br>
    respectively. See the sample for further clarifications. </p>
<!--l. 36--><!--l. 36-->
<p class="noindent"><span class="cmssbx-10x-x-144">Sample input and output</span> </p>
<!--l. 39--><!--l. 39-->
<p class="noindent"></p>
<div class="obeylines-v">
<!--tex4ht:inline--><!--tex4ht:inline--><div class="tabular">
<table id="TBL-4" class="tabular" cellspacing="0" cellpadding="0" rules="groups"><colgroup id="TBL-4-1g"><col id="TBL-4-1"><br></colgroup><colgroup id="TBL-4-2g"><col id="TBL-4-2"><br></colgroup><tr class="hline"><td>
<hr></td>
<td>
<hr></td>
</tr><tr style="vertical-align:baseline;" id="TBL-4-1-"><td style="white-space:nowrap; text-align:center;" id="TBL-4-1-1" class="&lt;br"></td>
            "td11"&gt;<br><div class="multicolumn" style="white-space:nowrap; text-align:center;">
                <span class="cmtt-10x-x-109">stdin</span>
              </div>

<td style="white-space:nowrap; text-align:center;" id="TBL-4-1-2" class="&lt;br"></td>
            "td11"&gt;<br><div class="multicolumn" style="white-space:nowrap; text-align:center;">
                <span class="cmtt-10x-x-109">stdout</span>
              </div>

</tr><tr class="hline"><td>
<hr></td>
<td>
<hr></td>
</tr><tr style="vertical-align:baseline;" id="TBL-4-2-"><td style="white-space:nowrap; text-align:left;" id="TBL-4-2-1" class="td11">
<div class="minipage">
<p class="noindent"><span class="cmtt-10x-x-109">9</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;15 </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...............</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...+------+....</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...|......|....</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...|...+--H----</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...|...|..|....</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">---I---H--+....</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...|...|.......</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...+---+.......</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...............</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">9</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;15 </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...............</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...+------+....</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...|......|....</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...|...+--I----</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...|...|..|....</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">---I---H--+....</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...|...|.......</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="cmtt-10x-x-109">...+---+.......</span> </p>
<!--l. 63--><!--l. 63-->
<p class="noindent"><span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;...............</p>
</div>
</td>
<td style="white-space:nowrap; text-align:left;" id="TBL-4-2-2" class="td11">
<div class="minipage">
<p class="noindent"><span class="cmtt-10x-x-109">Case</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;1: <span class="cmtt-10x-x-109">knotted</span></p>
<!--l. 63--><!--l. 63--><p class="noindent"><span class="cmtt-10x-x-109">Case</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;2: <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;straightened</p>
</div>
</td>
</tr><tr class="hline"><td>
<hr></td>
<td>
<hr></td>
</tr><tr style="vertical-align:baseline;" id="TBL-4-3-"><td style="white-space:nowrap; text-align:left;" id="TBL-4-3-1" class="td11">
            </td>
</tr></table></div>
</div>
</div>
    </div></div>