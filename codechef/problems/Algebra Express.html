<div style='width:800px;margin:50px'><div class="content">
<h3>All submissions for this problem are available.</h3>
<div id="kanpur">
<div class="tabular">
<table id="TBL-17" class="tabular" cellspacing="0" cellpadding="0"><colgroup id="TBL-17-1g"><col id="TBL-17-1"><br><col id="TBL-17-2"><br></colgroup><tr style="vertical-align:baseline;" id="TBL-17-1-"><td style="white-space:nowrap; text-align:center;" id="TBL-17-1-1" class="&lt;br"></td>
          "td11"&gt;<a id="x1-6r5" name="x1-6r5"></a> <span class="&lt;br"></span>
          "cmssbx-10x-x-600"&gt;E
<td style="white-space:nowrap; text-align:center;" id="TBL-17-1-2" class="&lt;br"></td>
          "td11"&gt;<br><!--tex4ht:inline--><!--tex4ht:inline--><div class="tabular">
<table id="TBL-18" class="tabular" cellspacing="0" cellpadding="0"><colgroup id="TBL-18-1g"><col id="TBL-18-1"><br></colgroup><tr style="vertical-align:baseline;" id="TBL-18-1-"><td style="white-space:nowrap; text-align:left;" id="TBL-18-1-1" class="&lt;br"></td>
                  "td11"&gt;<span class="cmssbx-10x-x-172">Algebra Express</span>
</tr><tr style="vertical-align:baseline;" id="TBL-18-2-"><td style="white-space:nowrap; text-align:left;" id="TBL-18-2-1" class="&lt;br"></td>
                  "td11"&gt;<br><!--tex4ht:inline--><!--tex4ht:inline--><div class="tabular">
<table id="TBL-19" class="tabular" cellspacing="0" cellpadding="0"><colgroup id="TBL-19-1g"><col id="TBL-19-1"><br><col id="TBL-19-2"><br></colgroup><tr style="vertical-align:baseline;" id="TBL-19-1-"><td style="white-space:nowrap; text-align:left;" id="&lt;br"></td>
                          "TBL-19-1-1" class="td10"&gt;Input file:
<td style="white-space:nowrap; text-align:left;" id="&lt;br"></td>
                          "TBL-19-1-2" class="td01"&gt;<span class="&lt;br"></span>
                          "cmtt-10x-x-109"&gt;stdin
</tr><tr style="vertical-align:baseline;" id="TBL-19-2-"><td style="white-space:nowrap; text-align:left;" id="&lt;br"></td>
                          "TBL-19-2-1" class="td10"&gt;Output file:
<td style="white-space:nowrap; text-align:left;" id="&lt;br"></td>
                          "TBL-19-2-2" class="td01"&gt;<span class="&lt;br"></span>
                          "cmtt-10x-x-109"&gt;stdout
</tr><tr style="vertical-align:baseline;" id="TBL-19-3-"><td style="white-space:nowrap; text-align:left;" id="&lt;br"></td>
                          "TBL-19-3-1" class="td10"&gt;
</tr></table></div>

</tr></table></div>

</tr><tr style="vertical-align:baseline;" id="TBL-17-2-"><td style="white-space:nowrap; text-align:center;" id="TBL-17-2-1" class="&lt;br"></td>
          "td11"&gt;
</tr></table></div>
<!--l. 4--><!--l. 4--><p class="noindent">Mim is a high school algebra teacher. Just last week, she taught<br>
    her students how to evaluate an expression. For example, if</p>
<div class="center">
<!--l. 5--><!--l. 5--><p class="noindent">
<!--l. 6--><!--l. 6--></p>
<p class="noindent"><span class="cmmi-10x-x-109">r</span> = <span class="&lt;br"></span>
      "cmmi-10x-x-109"&gt;a <span class="cmsy-10x-x-109">×</span> (<span class="&lt;br"></span>
      "cmmi-10x-x-109"&gt;b + <span class="cmmi-10x-x-109">c</span>) <span class="&lt;br"></span>
      "cmsy-10x-x-109"&gt;− <span class="cmmi-10x-x-109">d</span> <span class="&lt;br"></span>
      "cmsy-10x-x-109"&gt;× <span class="cmmi-10x-x-109">e</span></p>
</div>
<!--l. 8--><!--l. 8--><p class="noindent">Given the values of <span class="cmmi-10x-x-109">a</span>,<br><span class="cmmi-10x-x-109">b</span>, <span class="cmmi-10x-x-109">c</span>,<br><span class="cmmi-10x-x-109">d</span> and <span class="cmmi-10x-x-109">e</span>, they<br>
    can evaluate <span class="cmmi-10x-x-109">r</span>. </p>
<!--l. 10--><!--l. 10-->
<p class="noindent">Now, to test how well her students are able to do these<br>
    arithmetic, she has to prepare some test. But, she do this every year, and each time<br>
    she has to make same type of questions. That made her a little bored. She thinks that<br>
    evaluating an expression only depends on the position of operators and variables, not<br>
    the variables itself. For example in the expression above, for all possible values of<br><span class="cmmi-10x-x-109">a</span>, <span class="cmmi-10x-x-109">b</span>,<br><span class="cmmi-10x-x-109">c</span>, <span class="cmmi-10x-x-109">d</span> and<br><span class="cmmi-10x-x-109">e</span>, they will all be equally hard to evaluate. </p>
<!--l. 14--><!--l. 14-->
<p class="noindent">She has made some generic expressions, and a set of values, which<br>
    she may use in any order (e.g. one time she may use <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;a = 2, <span class="cmmi-10x-x-109">b</span> = 5, another<br>
    time she may use <span class="cmmi-10x-x-109">a</span> = 5, <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;b = 2). Now, she wants to know, the number of possible ways<br>
    to assign these values, so that, the value of the expression lies within a specified<br>
    limit. </p>
<!--l. 18--><!--l. 18-->
<p class="noindent"><span class="cmssbx-10x-x-144">Input</span> </p>
<!--l. 20--><!--l. 20-->
<p class="noindent">First line contains <span class="cmmi-10x-x-109">T</span>, the<br>
    number of test cases. </p>
<!--l. 22--><!--l. 22-->
<p class="noindent">Each test case starts with three integers <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;N(2 <span class="cmsy-10x-x-109">≤</span> <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;N <span class="cmsy-10x-x-109">≤</span> 12), <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;l, <span class="cmmi-10x-x-109">h</span> (<span class="&lt;br"></span>
    "cmsy-10x-x-109"&gt;−10<sup><span class="cmr-8">12</span></sup><br><span class="cmsy-10x-x-109">≤</span> <span class="cmmi-10x-x-109">l</span><br><span class="cmsy-10x-x-109">≤</span> <span class="cmmi-10x-x-109">h</span><br><span class="cmsy-10x-x-109">≤</span> 10<sup><span class="cmr-8">12</span></sup>),<br>
    the number of variables, lower limit and the upper limit of the acceptable expression<br>
    values. </p>
<!--l. 24--><!--l. 24-->
<p class="noindent">Next line contains <span class="cmmi-10x-x-109">N</span> integers<br><span class="cmmi-10x-x-109">a</span><sub><span class="cmmi-8">i</span></sub>(0<br><span class="cmsy-10x-x-109">≤</span> <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;a<sub><span class="cmmi-8">i</span></sub><span class="&lt;br"></span>
    "cmsy-10x-x-109"&gt;≤ 9), the value of the variables she will be using in the<br>
    exam. </p>
<!--l. 26--><!--l. 26-->
<p class="noindent">Next line contains the expression, where each variable is<br>
    represented as ‘<span class="cmtt-10x-x-109">x</span>’. The expression<br>
    will be well formed, and will contain only the symbols ‘+’,<br>
    ‘-’, ‘*’,‘(’,‘)’ and<br>
    ‘<span class="cmtt-10x-x-109">x</span>’. </p>
<!--l. 30--><!--l. 30-->
<p class="noindent"><span class="cmssbx-10x-x-144">Output</span> </p>
<!--l. 32--><!--l. 32-->
<p class="noindent">For each test case, output the number of different assignments,<br>
    that produce results within the limit [<span class="cmmi-10x-x-109">l, h</span>]. </p>
<!--l. 34--><!--l. 34-->
<p class="noindent">Note that, you will be replacing each ‘<span class="&lt;br"></span>
    "cmtt-10x-x-109"&gt;x’ with a value <span class="&lt;br"></span>
    "cmmi-10x-x-109"&gt;a<sub><span class="cmmi-8">j</span></sub>(1 <span class="&lt;br"></span>
    "cmsy-10x-x-109"&gt;≤ <span class="cmmi-10x-x-109">j</span> <span class="&lt;br"></span>
    "cmsy-10x-x-109"&gt;≤ <span class="cmmi-10x-x-109">N</span>). Each<br><span class="cmmi-10x-x-109">a</span><sub><span class="cmmi-8">j</span></sub> have to<br>
    be used exactly once. Two assignments are considered the same, if, after replacing<br>
    all ‘<span class="cmtt-10x-x-109">x</span>’, the expressions look the<br>
    same. </p>
<!--l. 37--><!--l. 37-->
<p class="noindent"><span class="cmssbx-10x-x-144">Sample input and output</span> </p>
<!--l. 40--><!--l. 40-->
<p class="noindent"></p>
<div class="obeylines-v">
<!--tex4ht:inline--><!--tex4ht:inline--><div class="tabular">
<table id="TBL-20" class="tabular" cellspacing="0" cellpadding="0" rules="&lt;br"></table>
        "groups"&gt;<br><colgroup id="TBL-20-1g"><col id="TBL-20-1"><br></colgroup><colgroup id="TBL-20-2g"><col id="TBL-20-2"><br></colgroup><tr class="hline"><td>
<hr></td>
<td>
<hr></td>
</tr><tr style="vertical-align:baseline;" id="TBL-20-1-"><td style="white-space:nowrap; text-align:center;" id="TBL-20-1-1" class="&lt;br"></td>
            "td11"&gt;<br><div class="multicolumn" style="white-space:nowrap; text-align:center;">
                <span class="cmtt-10x-x-109">stdin</span>
              </div>

<td style="white-space:nowrap; text-align:center;" id="TBL-20-1-2" class="&lt;br"></td>
            "td11"&gt;<br><div class="multicolumn" style="white-space:nowrap; text-align:center;">
                <span class="cmtt-10x-x-109">stdout</span>
              </div>

</tr><tr class="hline"><td>
<hr></td>
<td>
<hr></td>
</tr><tr style="vertical-align:baseline;" id="TBL-20-2-"><td style="white-space:nowrap; text-align:left;" id="TBL-20-2-1" class="&lt;br"></td>
            "td11"&gt;<br><div class="minipage">
<p class="noindent"><span class="cmtt-10x-x-109">3</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">3</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;1 <span class="cmtt-10x-x-109">10</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">1</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;2 <span class="cmtt-10x-x-109">5</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">x+x*x</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">4</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;1 <span class="cmtt-10x-x-109">10</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">1</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;2 <span class="cmtt-10x-x-109">2</span><br><span class="cmtt-10x-x-109">5</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">(x+x)*(x-x)</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">4</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;1 <span class="cmtt-10x-x-109">100</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">1</span> <span class="&lt;br"></span>
                "cmtt-10x-x-109"&gt;1 <span class="cmtt-10x-x-109">1</span><br><span class="cmtt-10x-x-109">1</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">x*(x-(x*x))</span></p>
</div>

<td style="white-space:nowrap; text-align:left;" id="TBL-20-2-2" class="&lt;br"></td>
            "td11"&gt;<br><div class="minipage">
<p class="noindent"><span class="cmtt-10x-x-109">4</span> </p>
<!--l. 55--><!--l. 55--><p></p><p class="noindent"><span class="cmtt-10x-x-109">4</span> </p>
<!--l. 55--><!--l. 55-->
<p class="noindent"><span class="cmtt-10x-x-109">0</span></p>
</div>

</tr><tr class="hline"><td>
<hr></td>
<td>
<hr></td>
</tr><tr style="vertical-align:baseline;" id="TBL-20-3-"><td style="white-space:nowrap; text-align:left;" id="TBL-20-3-1" class="&lt;br"></td>
            "td11"&gt;
</tr></div></div></div></div></div>